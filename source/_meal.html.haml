- r = restaurant(meal.restaurant_id)
%div{ class: ['event', 'meal', meal.name.downcase, r&.priority].compact.join(' '), data: { 'event-id' => event.id, 'eventable-id' => meal.id, 'eventable-type' => 'meal', 'meal-id' => meal.id } }
  %h4.name= meal.name
  - if r
    .restaurant{ data: { 'restaurant-id' => r.id } }
      %h5.name= r.name
      = partial('links', locals: { links: r.links })
      - if r.address
        .address= r.address
      - if r.phone
        .phone= r.phone
      - if r.hours
        .hours= r.hours
      - if r.price_range
        .price-range= r.price_range
      - if r.genre
        .genre= r.genre
      - if r.frommers_guide_book_page
        %cite.frommers-guide-book-page= r.frommers_guide_book_page
  - rs = ratings(meal.id)
  - if rs.present?
    .ratings
      %div{ class: ['average', "#{['one', 'two', 'three', 'four', 'five'][(rs.map(&:rating).inject(&:+) / rs.length) - 1]}-star"].compact.join(' ') }
      - rs.each do |rating|
        - p = person(rating.person_id)
        %div{ class: ['rating', p['name'].downcase].compact.join(' ') }= "#{p['name']}: #{rating.rating}"
  - if meal.food
    .food
      - meal.food.each do |name, selection|
        .selection
          %h6.name= name
          %ul.items
            - selection.each do |item|
              %li= item
  - if meal.notes
    .notes= meal.notes
